{% comment %}
	Given an array of member IDs (`name` attributes), return a list of
	full names (member `title` attributes), optionally hyperlinked to
	the correct member page.

	Expects two parameters:

		`member_list`
		An array of one or more member `name` attributes.

		`link_members`
		Truthy/Falsy directive (in the Liquid sense) indicating whether
		or not member names should be linked to member pages.
{% endcomment %}

{% comment %}
	Build array of members.
{% endcomment %}
{% assign members = "" | split: "" %}
{% for the_page in site.pages %}
	{% assign path_array = the_page.url | replace: "/", " " | strip | split: " " %}
	{% assign path_size = path_array | size %}
	{% if path_array[0] == "members" and path_size == 2 %}
		{% assign members = members | push: the_page %}
	{% endif %}
{% endfor %}

{% comment %}
	Do the thing.
{% endcomment %}
{% assign total_members = include.member_list.size %}
{% if total_members == 1 %}
	{% assign member_file = include.member_list[0] | append: ".md" %}
	{% assign member = members | where: "name", member_file | first %}
	{% if include.link_members %}<a href="/members/{{ include.member_list[0] }}/">{% endif %}{{ member.title | replace: " ", "&nbsp;" }}{% if include.link_members %}</a>{% endif %}
{% elsif total_members == 2 %}
	{% assign first_member_file = include.member_list[0] | append: ".md" %}
	{% assign first_member = members | where: "name", first_member_file | first %}
	{% assign second_member_file = include.member_list[1] | append: ".md" %}
	{% assign second_member = members | where: "name", second_member_file | first %}

	{% if include.link_members %}<a href="/members/{{ include.member_list[0] }}/">{% endif %}{{ first_member.title | replace: " ", "&nbsp;" }}{% if include.link_members %}</a>{% endif %}
	&amp;
	{% if include.link_members %}<a href="/members/{{ include.member_list[1] }}/">{% endif %}{{ second_member.title | replace: " ", "&nbsp;" }}{% if include.link_members %}</a>{% endif %}
{% else %}
	{% assign last_member = include.member_list.last %}
	{% for member_id in include.member_list %}
		{% assign member_file = member_id | append: ".md" %}
		{% assign member = members | where: "name", member_file | first %}

		{% if include.link_members %}<a href="/members/{{ member_id }}/">{% endif %}{{ member.title | replace: " ", "&nbsp;" }}{% if include.link_members %}</a>{% endif %}{% if member_id != last_member %}, {% endif %}
	{% endfor %}
{% endif %}
