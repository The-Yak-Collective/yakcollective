---
title: 'TryHackMe: Complete Beginner'
date: 2021-10-11 05:00:00.000000000 Z
layout: post-external
original_link: https://cardboard-iguana.com/log/2021-10-11-tryhackme-complete-beginner.html
author: 100007
---

<h1 id="tryhackme-complete-beginner">TryHackMe: Complete Beginner</h1>
<p><strong>author:</strong> Nathan Acks<br />
<strong>date:</strong> 2021-10-11</p>
<h2 id="hashing">Hashing</h2>
<h3 id="what-is-a-hash-function">What is a Hash Function?</h3>
<p>Apparently hashes are sometimes represented in base64. I’ve never seen this myself.</p>
<p>The MD5 algorithm outputs a 128 bit (16 byte) hash.</p>
<h3 id="uses-for-hashing">Uses for Hashing</h3>
<p>REMINDER: For salting to be effective, the salt needs to be <em>different</em> for each user!</p>
<ul>
<li><a href="https://www.cellphonetrackers.org/tool/md5-coder.php">MD5 hash cracker</a></li>
</ul>
<h3 id="recognizing-password-hashes">Recognizing Password Hashes</h3>
<p>Recognizing hash types from first principles is generally unreliable (which makes sense — for a hash to maximally cover the space allocated by its size, it can’t have any ”patterns” to it). Some general notes:</p>
<p>UNIX-style passwords are of the form <code class="language-plaintext highlighter-rouge">$format$rounds$salt$hash</code>. Common <code class="language-plaintext highlighter-rouge">format</code> parameters:</p>
<ul>
<li>1 — md5crypt (mostly older)</li>
<li>2, 2a, 2b, 2x, 2y — bcrypt (generally web apps)</li>
<li>6 — sha512crypt (most modern systems)</li>
</ul>
<p>Both $rounds and $salt are optional (salts are never purely numeric, so it’s easy to tell these apart).</p>
<p>NTLM hashes are an md4 variant. You can’t tell NTLM from md4 from md5 hashes just by looking at them (they’re all the same length). Windows stores passwords in the SAM, split between NT hashes (a.k.a. NTLM, though technically NTLM is the <em>protocol</em>) and LM hashes (an older, much weaker, hash type).</p>
<p>LM hashes are constructed in an absolutely batshit crazy fashion, but NT hashes are just the md4 hash of the UTF-16-LE encoding of the user password (UTF-16-LE is the little endian version of UTF-16).</p>
<ul>
<li><a href="https://medium.com/@petergombos/lm-ntlm-net-ntlmv2-oh-my-a9b235c58ed4">LM, NTLM, Net-NTLMv2, oh my!</a></li>
</ul>
<p>NOTE: 1 hex digit = 4 bits</p>
<h3 id="password-cracking">Password Cracking</h3>
<p>Bcrypt is designed to take approximately the same amount of time when hashed on a CPU vs. a GPU, which is one reason it’s considered more resistant to cracking.</p>
<p>Hashcat command line:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat <span class="nt">-m</span> <span class="nv">$TYPE</span> <span class="nt">-O</span> <span class="nv">$HASHFILE</span> <span class="nv">$WORDLIST</span>
</code></pre></div></div>
<p>Here $TYPE is the hash type (check <code class="language-plaintext highlighter-rouge">man hashcat</code>), and -O requests that hashcat use an optimized kernel (faster, but limited in the password length that can be cracked).</p>
<p>Some values of -m:</p>
<ul>
<li>0 — md5</li>
<li>1400 — sha256</li>
<li>1800 — UNIX SHA-512 passwords</li>
<li>3200 — bcrypt</li>
</ul>
<p>Passwords are output as HASH:PLAINTEXT tuples.</p>
<p>A “token length exception” means that the provided hash format is of the wrong length (probably because an additional character got accidentally added).</p>