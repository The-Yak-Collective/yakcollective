---
title: 'TryHackMe: Complete Beginner (Supplements)'
date: 2021-11-27 12:00:00.000000000 Z
layout: post-external
original_link: https://cardboard-iguana.com/log/2021-11-27-tryhackme-complete-beginner-supplements.html
author: 100007
---

<h1 id="tryhackme-complete-beginner-supplements">TryHackMe: Complete Beginner (Supplements)</h1>
<p><strong>author:</strong> Nathan Acks<br />
<strong>date:</strong> 2021-11-27</p>
<h1 id="wireshark-101">Wireshark 101</h1>
<h2 id="icmp-traffic">ICMP Traffic</h2>
<p>ICMP traffic “types” correspond to the kind of packet being sent (though different ICMP services can have multiple types):</p>
<ul>
<li>0 - Ping reply</li>
<li>8 - Ping request</li>
</ul>
<p>See RFC 792 for the gory details.</p>
<p>Ping packets typically just include either random data or all zeros.</p>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc792">RFC 792: Internet Control Message Protocol</a></li>
</ul>
<h2 id="tcp-traffic">TCP Traffic</h2>
<p>The TCP “acknowledgment number” contains the <em>next</em> sequence number that the sender is expecting to receive (so basically senders determine the next sequence number). This is 0 in the case of RST packets (and other errors?).</p>
<p>See RFC 793 for more.</p>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc793">RFC 793: Transmission Control Protocol</a></li>
</ul>
<h2 id="dns-traffic">DNS Traffic</h2>
<p>Apparently DNS over TCP is sufficiently rare in the wild as to always warrant further investigation.</p>
<h2 id="http-traffic">HTTP Traffic</h2>
<p>HTTP does not use handshakes (beyond the standard initial TCP handshake); it’s all request/response (a bit like ICMP that way).</p>
<p>Wireshark can actually save off webpages and other files transmitted over HTTP using File &gt; Export Objects &gt; HTTP. Neat!</p>
<p>Also worth checking out some of the tools in the Statistics menu; TryHackMe specifically calls out Protocol Hierarchy and Endpoints, but I think I need to see some practical examples of these in action to really grasp their utility.</p>
<h2 id="https-traffic">HTTPS Traffic</h2>
<p>HTTPS traffic starts out with an SSL handshake. All application data after the handshake is completed will be encrypted, but if you <em>happen</em> to have the server’s private key then Wireshark can display the decrypted contents.</p>
<ul>
<li>Import the key under Edit &gt; Preferences &gt; Protocols &gt; TLS &gt; RSA keys list.</li>
<li>Make sure to fill in the (server) IP address, port, and protocol (there’s also a “password” field, if the key’s encrypted). Note that port and protocol a bit reversed from what you’d expect - for HTTPS, these values are <code class="language-plaintext highlighter-rouge">start_tls</code> and <code class="language-plaintext highlighter-rouge">http</code>, respectively.</li>
</ul>
<p>Note that HTTPS is much more likely to break up data between packets than HTTP, so the ability to export files from the packet stream is much more useful here!</p>
<h2 id="analyzing-exploit-pcaps">Analyzing Exploit PCAPs</h2>
<p>DCERPC is Windows Server’s RPC connection protocol.</p>
<p>DRSUAPI is Windows’ implementation of the “Directory Replication Service” protocol, which is used to keep domain controllers in sync.</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/DCE/RPC">DCE/RPC (Wikipedia)</a></li>
<li><a href="https://wiki.samba.org/index.php/DRSUAPI">DRSUAPI</a></li>
</ul>
<h1 id="wifi-hacking-101">Wifi Hacking 101</h1>
<h2 id="the-basics-an-intro-to-wpa">The Basics: An Intro to WPA</h2>
<p>Because I always get these confused:</p>
<p>SSID - The wireless network “display” name.
BSSID - The MAC address of the access point currently being used.
ESSID - A collection of BSSIDs representing a single network. More-or-less analogous to SSID (when used in the context of networks consisting of multiple access points).</p>
<p>From what I can tell, SSID and BSSID apply to single access points, while ESSID applies to an entire network of access points.</p>
<h2 id="aircrack-ng-lets-get-cracking">Aircrack-NG: Let’s Get Cracking</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aircrack-ng <span class="nt">-b</span> <span class="nv">$BSSID</span> <span class="nt">-w</span> <span class="nv">$WORLDLIST_FILE</span> <span class="nv">$CAP_FILE</span>
</code></pre></div></div>