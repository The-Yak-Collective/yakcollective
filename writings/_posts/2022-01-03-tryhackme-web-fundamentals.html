---
title: 'TryHackMe: Web Fundamentals'
date: 2022-01-03 12:00:00.000000000 Z
layout: post-external
original_link: https://cardboard-iguana.com/log/2022-01-03-tryhackme-web-fundamentals.html
author: 100007
---

<h1 id="tryhackme-web-fundamentals">TryHackMe: Web Fundamentals</h1>
<p><strong>author:</strong> Nathan Acks<br />
<strong>date:</strong> 2022-01-03</p>
<h1 id="introduction-to-django">Introduction to Django</h1>
<h2 id="introduction">Introduction</h2>
<blockquote>
<p>“Additionally, Django is arguably one of the most secure developing frameworks, which in the right configuration, can strongly resist against SQL injections and XSS.”</p>
<p>– Swafox in the “Introduction to Django” room</p>
</blockquote>
<p>That’s a hell of a statement. We shall see.</p>
<ul>
<li><a href="https://tryhackme.com/p/Swafox">Swafox (TryHackMe user profile)</a></li>
<li><a href="https://tryhackme.com/room/django">TryHackMe: Introduction to Django</a></li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<p>Kali Linux comes with Django 3.2.10 pre-installed. I’m going to use that and hope it’s not <em>too</em> different from 2.2.12.</p>
<h2 id="creating-a-website">Creating a Website</h2>
<p>Okay, one difference between Django 2.2 and 3.2 is that the import of <code class="language-plaintext highlighter-rouge">django.urls</code> in <code class="language-plaintext highlighter-rouge">urls.py</code> does <em>not</em> pull in <code class="language-plaintext highlighter-rouge">include()</code> in 3.2. So this needs to be added manually before inserting additional <code class="language-plaintext highlighter-rouge">urlpattern</code> elements.</p>
<p>The app created with <code class="language-plaintext highlighter-rouge">python3 manage.py startapp articles</code> also doesn’t include a <code class="language-plaintext highlighter-rouge">urls.py</code> file (though this seems to be by design; I checked a few other tutorials, and it isn’t listed there either). This meant that I had to construct <em>both</em> a basic <code class="language-plaintext highlighter-rouge">urls.py</code> and <code class="language-plaintext highlighter-rouge">views.py</code> file in <code class="language-plaintext highlighter-rouge">articles/</code> before <code class="language-plaintext highlighter-rouge">python3 manage.py migrate</code> could successfully set up the new app.</p>
<h2 id="ctf">CTF</h2>
<p>This CTF involves a Django site. The target is at 10.10.219.71.</p>
<p>Going to http://10.10.219.71:8000/ reveals an error page stating that the target IP needs to be added to the <code class="language-plaintext highlighter-rouge">ALLOWED_HOSTS</code> array.</p>
<p>The provided username and password gets us into the target via SSH; we can see a Django project called <code class="language-plaintext highlighter-rouge">messagebox</code> here. Adding <code class="language-plaintext highlighter-rouge">10.10.219.71</code> to the <code class="language-plaintext highlighter-rouge">ALLOWED_HOSTS</code> array in <code class="language-plaintext highlighter-rouge">~/messagebox/messagebox/settings.py</code> resolves the initial error, though it takes a few minutes to reload.</p>
<p>The app now directs us to http://10.10.219.71:8000/messages/, where there’s a kind of weird stream-of-consciousness wall of text. At the bottom of this is a “Decode this message?” prompt, but clicking “Yes” results in an error dialog.</p>
<p>The Django admin interface at http://10.10.219.71:8000/admin/ doesn’t accept the SSH credentials.</p>
<p>Poking around more on the server, it turns out that the error produced by the “Decode this message?” prompt is hard-coded. Which I could probably have figured out if I looked at the page source.</p>
<ul>
<li>Running <code class="language-plaintext highlighter-rouge">strings db.sqlite3 | grep THM</code> reveals the first flag.</li>
</ul>
<p>Running <code class="language-plaintext highlighter-rouge">sudo -l</code> reveals that the <code class="language-plaintext highlighter-rouge">django-admin</code> user has full superuser access. Using this, we can conduct a search of the entire filesystem for “THM” style flags.</p>
<ul>
<li>The second flag is in <code class="language-plaintext highlighter-rouge">/home/StrangerFox/user.txt</code>.</li>
<li>The third flag is embedded as an HTML comment near the bottom of <code class="language-plaintext highlighter-rouge">~/meddagebox/messagebox/home.html</code>.</li>
</ul>