---
title: 'ITPro.TV: CompTIA Security+ (SY0-601) &amp; TryHackMe: Jr. Penetration Tester'
date: 2022-04-02 12:00:00.000000000 Z
layout: post-external
original_link: https://cardboard-iguana.com/log/2022-04-02-itprotv-comptia-security-plus-and-tryhackme-jr-penetration-tester.html
author: 100007
---

<h1 id="itprotv-comptia-security-sy0-601--tryhackme-jr-penetration-tester">ITPro.TV: CompTIA Security+ (SY0-601) &amp; TryHackMe: Jr. Penetration Tester</h1>
<p><strong>author:</strong> Nathan Acks<br />
<strong>date:</strong> 2022-04-02</p>
<h1 id="comptia-security-exam-cram">CompTIA Security+ Exam Cram</h1>
<p>Today I’ll be covering Chapter 22 of the Security+ Exam Cram, “Cloud Cybersecurity Solutions”.</p>
<h2 id="introduction">Introduction</h2>
<p>Cloud platform security controls: A wall of toggle. So many toggles…</p>
<h2 id="cloud-workloads">Cloud Workloads</h2>
<p>Key security concerns:</p>
<ul>
<li>Authentication</li>
<li>Proper permissions</li>
<li>Usage tracking</li>
</ul>
<p>In AWS, both servers and users are assigned permissions.</p>
<h2 id="regions-and-availability-zones">Regions and Availability Zones</h2>
<p>Region = Geographic area</p>
<p>Availability Zone = Locations within a region</p>
<p>Regions provide control over pricing, local regulations, and (gross) latency.</p>
<p>Availability zones allow for redundancy.</p>
<h2 id="virtual-private-cloud-vpc">Virtual Private Cloud (VPC)</h2>
<p>This is basically the private internal networks used to connect cloud resources. “VPC endpoints” allow connections to other cloud resources, but are generally one-way (requests must be initiated by resources within the VPC).</p>
<p>Security best practices for a VPC are basically the same as those for a regular network, except that there’s often finer-grained control via security groups and cloud platform policies. API monitoring also needs to be taken into account.</p>
<h2 id="security-groups">Security Groups</h2>
<p>Security groups can be thought of as firewalls, as they determine what traffic may be sent/received by resources within the group. General properties (seems AWS-specific):</p>
<ul>
<li>Default-deny (allow only)</li>
<li>Port 22 inbound is generally allowed</li>
<li>Destination ports only</li>
<li>Stateful</li>
</ul>
<p>Network ACLs basically function as <em>stateless</em> firewalls.</p>
<h2 id="policies">Policies</h2>
<p>Policies are bundles of permissions. Two general categories:</p>
<ul>
<li>Identity-based policies define access based on the user (or service account). Account X has access to resource Y.</li>
<li>Resource-based policies define access based on resource. Resource Y allows account X access.</li>
</ul>
<p>The symmetry here can make things a little muddy. General rules:</p>
<ul>
<li>Default deny.</li>
<li>An explicit allow in either an identity- or resource-based policy functions as an allow.</li>
<li>An explicit deny in either an identity- or resource-based policy overrides an explicit allow.</li>
</ul>
<p>So, the way to think of composite policies is basically to sum up the explicitly allowed actions in all policies and then remove the explicitly denied actions. The resulting set should be the actual permissions of a given user/account.</p>
<p>Note that on all (most?) cloud systems, policies only apply to actions, <em>not</em> network traffic.</p>
<h2 id="managing-secrets">Managing Secrets</h2>
<p>Basically, use the built-in secrets management functionality of your platform.</p>
<h2 id="central-logging">Central Logging</h2>
<p>Basically, log all the things. But if you can’t log all the things, then log:</p>
<ul>
<li>Privileged account actions</li>
<li>Log access</li>
<li>Authentication attempts</li>
<li>Resource/Object creation/deletion</li>
</ul>
<h2 id="third-party-cloud-security-solutions">Third-Party Cloud Security Solutions</h2>
<p>CASB = Cloud Access Security Broker</p>
<p>The use case I’m familiar with for CASBs is controlling SaaS access from corporate networks/devices. This can be extended to the management interface for cloud services. Similar functionality is apparently enabled by services known as “secure web gateways” (SWGs) and “software defined perimeters” (SDPs). Exam Cram is implying here that at least some of these technologies can be layered in front of the relevant application / management interface on the vendor side or via a proxy (in which case the application / management interface would be restricted to only talk to the relevant application IPs)</p>
<p>AWS apparently has a “marketplace” (sounds a bit like the Google Workspace add-ons “marketplace) that specifically offers integrations with security tools.</p>
<p>“Structural awareness” solutions (protections applied directly to resources/objects):</p>
<ul>
<li>Compliance / Best practices</li>
<li>Visibility / Monitoring</li>
<li>VPN</li>
<li>Encryption management</li>
<li>Vulnerability assessment</li>
<li>SBOM-like</li>
<li>Log / Data aggregation</li>
<li>DevSecOps</li>
<li>Risk management</li>
</ul>
<p>“Situational awareness” solutions (monitor and respond to events):</p>
<ul>
<li>Firewalls / Proxies (packet inspection)</li>
<li>EDR</li>
<li>IDS</li>
<li>Backups</li>
<li>Disaster recovery</li>
<li>SIEM</li>
<li>Workload-based security controls</li>
</ul>
<h1 id="tryhackme-jr-penetration-tester">TryHackMe: Jr. Penetration Tester</h1>
<h2 id="tcp-and-udp-ports">TCP and UDP Ports</h2>
<p>Six nmap port states:</p>
<ul>
<li><code class="language-plaintext highlighter-rouge">Open</code> - The port is reachable and there is a service listening on it.</li>
<li><code class="language-plaintext highlighter-rouge">Closed</code> - The port is reachable and there is no service listening on it.</li>
<li><code class="language-plaintext highlighter-rouge">Filtered</code> - Nmap cannot determine the port state because the port is not accessible (probably because of a firewall).</li>
<li><code class="language-plaintext highlighter-rouge">Unfiltered</code> - Nmap cannot determine the port state, but the port <em>is</em> accessible (only encountered in ACK scans).</li>
<li><code class="language-plaintext highlighter-rouge">Open|Filtered</code> - Nmap can only determine that the port is not closed (only encountered in UDP scans and more exotic scans like Xmas).</li>
<li><code class="language-plaintext highlighter-rouge">Closed|Filtered</code> - Nmap can only determine that the port is not open (only encountered in IP ID idle scans).</li>
</ul>
<p>Reference:</p>
<ul>
<li><a href="https://nmap.org/book/man-port-scanning-basics.html">Port Scanning Basics (Official Nmap Project Guide)</a></li>
</ul>
<h2 id="tcp-flags">TCP Flags</h2>
<p>Available TCP flags:</p>
<ul>
<li>URG - Process the current TCP packet immediately. Directs the receiving system to examine the “urgent pointer” field.</li>
<li>ACK - Acknowledgement. Directs the receiving system to examine the “acknowledgement number” field.</li>
<li>PSH - Push. Elevate the priority of the packet’s data, but does not otherwise change rules around packet processing.</li>
<li>RST - Reset. Terminates the connection forcefully.</li>
<li>SYN - Synchronize. Used during the initial three-way handshake to set a shared (starting) sequence number.</li>
<li>FIN - Finish. Indicates that the connection may be dropped gracefully.</li>
</ul>
<p>Reference:</p>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc793.html">Transmission Control Protocol (RFC 793)</a></li>
</ul>
<h2 id="tcp-connect-scan">TCP Connect Scan</h2>
<p>TCP connect scans attempt to perform the full three-way handshake for each port, but then immediately tears down the connection using RST/ACK.</p>
<p>Specified using <code class="language-plaintext highlighter-rouge">-sT</code>. Slow.</p>
<p>The only scan available for unprivileged users.</p>
<p>Unless <code class="language-plaintext highlighter-rouge">-p</code> is specified, only the 1000 most common ports are scanned. If <code class="language-plaintext highlighter-rouge">-F</code> is specified, then only the 100 more common ports are scanned.</p>
<p>Nmap normally scans ports in a random order. However, ports are often brought up consecutively, so for freshly booted targets the <code class="language-plaintext highlighter-rouge">-r</code> flag (which <em>removes</em> this randomization) can be advisable.</p>
<h2 id="tcp-syn-scan">TCP SYN Scan</h2>
<p>TCP SYN scans (<code class="language-plaintext highlighter-rouge">-sS</code>) are nmap’s default; sends a RST instead of a ACK at the end of the three-way handshake.</p>
<p>Fast. Limited to privileged users.</p>
<h2 id="udp-scan">UDP Scan</h2>
<p>UDP scans are specified using <code class="language-plaintext highlighter-rouge">-sU</code>.</p>
<p>There is no UDP handshake, but a UDP packet sent to a closed port will generate an ICMP port unreachable packet unless either the UDP packet or ICMP response is blocked by a firewall.</p>
<p>Unfortunately, a UDP packet sent to an open port isn’t guaranteed to generate a reply. Nmap tries to work around this by sending packet that are likely to elicit a response for common protocols, but this is an inexact thing.</p>
<p>Note that <code class="language-plaintext highlighter-rouge">-sS</code> and <code class="language-plaintext highlighter-rouge">-sU</code> can be specified simultaneously, in which case nmap will perform <em>both</em> scans in parallel.</p>
<ul>
<li><a href="https://nmap.org/book/scan-methods-udp-scan.html">UDP Scan (-sU) (Official Nmap Project Guide)</a></li>
</ul>
<h2 id="fine-tuning-scope-and-performance">Fine-Tuning Scope and Performance</h2>
<p>Use <code class="language-plaintext highlighter-rouge">--top-ports 10</code> to scan only the ten most common ports.</p>
<p>Timing can be specified with the <code class="language-plaintext highlighter-rouge">-T</code> flag, which takes a template number 0 - 5.</p>
<p><code class="language-plaintext highlighter-rouge">-T0</code> waits 5 minutes between port scans, and is thus <em>not</em> something you’d want to use when scanning a full port range (doing so would take over 7 months!). It is <em>very</em> unlikely to trigger IDS alerts.</p>
<p><code class="language-plaintext highlighter-rouge">-T1</code> is also slow (but not nearly as slow as <code class="language-plaintext highlighter-rouge">T0</code>!), and is typically used in real engagements.</p>
<p><code class="language-plaintext highlighter-rouge">-T3</code> is nmap’s default.</p>
<p><code class="language-plaintext highlighter-rouge">-T4</code> is generally used during CTFs and learning exercises.</p>
<p><code class="language-plaintext highlighter-rouge">-T5</code> is not recommended, as it scans so fast that packet loss is a distinct possibility.</p>
<p>Packet rate can also be bounded using <code class="language-plaintext highlighter-rouge">--min-rate</code> and <code class="language-plaintext highlighter-rouge">--max-rate</code> (single numbers representing packets-per-second). The number of <em>parallel</em> probes that nmap will have running at any one time can be bounded using <code class="language-plaintext highlighter-rouge">--min-parallelism</code> and <code class="language-plaintext highlighter-rouge">--max-parallelism</code>.</p>
<h2 id="tcp-null-scan-fin-scan-and-xmas-scan">TCP Null Scan, FIN Scan, and Xmas Scan</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-sN</code> - Null scan; no TCP flags are set. Used to circumvent <em>stateless</em> firewalls. Can distinguish between <code class="language-plaintext highlighter-rouge">closed</code> and <code class="language-plaintext highlighter-rouge">open|filtered</code>.</li>
<li><code class="language-plaintext highlighter-rouge">-sF</code> - FIN scan. Use and output is similar to a null scan, but is slightly more likely to be blocked.</li>
<li><code class="language-plaintext highlighter-rouge">-sX</code> - Xmas scan; the FIN, URG, and PSH TCP flags are set. Use and output is similar to a null scan.</li>
</ul>
<h2 id="tcp-maimon-scan">TCP Maimon Scan</h2>
<p><code class="language-plaintext highlighter-rouge">-sM</code> - Maimon scan (named after Uriel Maimon); the FIN and ACK TCP flags are set. Should always receive a RST, but some older BSD systems drop the packet on open ports. Of limited modern utility.</p>
<h2 id="tcp-ack-windows-and-custom-scan">TCP Ack, Windows, and Custom Scan</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-sA</code> - ACK scan. All ports <em>should</em> respond with a RST, but firewalls will generally block these requests except for open/forwarded ports. Thus, an ACK scan is useful for probing the configuration of intermediate firewalls (but says nothing about whether services are actually <em>listening</em> on the identified ports).</li>
<li><code class="language-plaintext highlighter-rouge">-sW</code> - TCP windows scan; the same as an ACK scan except that it examines the TCP window field of returned RST packets and uses it to discern if a port responded <em>differently</em>. Note that ports may be reported as closed (and open!) erroneously (as not all systems respond in the same way), but unfiltered ports will be identified. Look for patterns of open/closed ports to try to discern how the target system is responding.</li>
<li><code class="language-plaintext highlighter-rouge">--scanflags</code> - Specify the TCP flags used to probe ports during a scan using URG, PSH, RST, SYN, ACK, FIN (e.g., <code class="language-plaintext highlighter-rouge">--scanflags URGPSHFIN</code> is the same as <code class="language-plaintext highlighter-rouge">-sX</code>).</li>
</ul>
<p>Reference:</p>
<ul>
<li><a href="https://nmap.org/book/scan-methods-window-scan.html">TCP Window Scan (-sW) (Official Nmap Project Guide)</a></li>
</ul>
<h2 id="spoofing-and-decoys">Spoofing and Decoys</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-S</code> - Use a spoofed IP address for the scan. Only useful if you can actually capture incoming packets at that IP address! Generally must be combined with the <code class="language-plaintext highlighter-rouge">-e</code> and <code class="language-plaintext highlighter-rouge">-Pn</code> flags.</li>
<li><code class="language-plaintext highlighter-rouge">-e</code> - Specify the network interface to use during scanning.</li>
<li><code class="language-plaintext highlighter-rouge">-D</code> - Send multiple scan requests using decoys; specified using a list of arbitrary IP addresses. The special “addresses” ME and RND represent the attacker (you!) and a random IP address, respectively. Obviously, if you want results than “ME” will need to be included in the list <em>somewhere</em>. Trades stealth for “chaff”. Maybe only useful as a diversion?</li>
<li><code class="language-plaintext highlighter-rouge">--spoof-mac</code> - Use a spoofed MAC address for the scan. Obviously only matters when you’re on the same subnet as the target; otherwise has the same caveats as IP spoofing.</li>
</ul>
<h2 id="fragmented-packets">Fragmented Packets</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-f</code> - Fragment packets so that the packet is 8 bytes or less. Specify twice to fragment into 16 byte chunks (which is reverse of how you’d intuitively expect this to work). Can help evade some next-gen firewall / IDS alarms.</li>
<li><code class="language-plaintext highlighter-rouge">--mtu</code> - Choose the fragment length for <code class="language-plaintext highlighter-rouge">-f</code>; should always be a multiple of 8.</li>
<li><code class="language-plaintext highlighter-rouge">--data-length</code> - Append random data to nmap TCP packets. By default, nmap appends no data after the TCP header; padding this out <em>can</em> make scans look more innocuous. Disables protocol-specific payloads, which can decrease scan accuracy, particularly for UDP scans.</li>
</ul>
<p>Reference:</p>
<ul>
<li><a href="https://nmap.org/book/man-bypass-firewalls-ids.html">Firewall/IDS Evasion and Spoofing (Official Nmap Project Guide)</a></li>
</ul>
<h2 id="idlezombie-scan">Idle/Zombie Scan</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-sI</code> - Idle/Zombie scan. The idea here is to choose a machine with <em>no</em> traffic on it and then spoof it’s IP address. Scans then consist of a SYN/ACK to the zombie to get the current IP ID value for the current port, then a SYN to the target (which should either reply with a RST to the zombie, which doesn’t trigger a response and thus doesn’t increment the IP ID, or a SYN/ACK to the zombie, which will respond with a RST which <em>will</em> increment the IP ID), then a second SYN/ACK to the zombie to see if the IP ID has been incremented by 1 (port closed or filtered on the target) or 2 (port open on the target). Note that zombies need to be systems that increment the IP ID sequentially <em>and</em> globally, and open/closed ports will be from the <em>zombie’s</em> perspective, not the attacker’s. These scans are also slooooow (though not as slow as <code class="language-plaintext highlighter-rouge">-T0</code>).</li>
</ul>
<p>Reference:</p>
<ul>
<li><a href="https://nmap.org/book/idlescan.html">TCP Idle Scan (-sI) (Official Nmap Project Guide)</a></li>
</ul>
<h2 id="getting-more-details">Getting More Details</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-d</code> - Generate debugging output; use <code class="language-plaintext highlighter-rouge">-dd</code> for even more. This is essentially an additional verbosity leve, such that <code class="language-plaintext highlighter-rouge">-v</code> &lt; <code class="language-plaintext highlighter-rouge">-vv</code> &lt; <code class="language-plaintext highlighter-rouge">-d</code> &lt; <code class="language-plaintext highlighter-rouge">-dd</code>.</li>
<li><code class="language-plaintext highlighter-rouge">--reason</code> - Show the reason that nmap made a particular identification. Kinda fun.</li>
</ul>
<h2 id="summary-of-nmap-advanced-port-scans">Summary of Nmap Advanced Port Scans</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">--source-port</code> - Specify the source port for a scan. possibly useful to evade some firewall rules?</li>
</ul>
<h2 id="service-detection">Service Detection</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-sV</code> - Service detection scan. The same as <code class="language-plaintext highlighter-rouge">-sT</code> (because a full TCP connection is required to gather the necessary information), but probes listening services for additional information.</li>
<li><code class="language-plaintext highlighter-rouge">--version-intensity</code> - Determine how much service information to collect (and thus how noisy the associated probes will be) with <code class="language-plaintext highlighter-rouge">-sV</code>. Ranges from 0 - 9; <code class="language-plaintext highlighter-rouge">--version-light</code> is equivalent to 2, <code class="language-plaintext highlighter-rouge">--version-all</code> is equivalent to 9.</li>
</ul>
<h2 id="os-detection-and-traceroute">OS Detection and Traceroute</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-O</code> - OS detection. Generally requires at least one open and one closed port to be detected, and results will be distorted if the target is virtualized. The OS type is much more reliably detected than the OS version.</li>
<li><code class="language-plaintext highlighter-rouge">--traceroute</code> - Perform a traceroute between the attacker and target systems. Note that nmap’s traceroute works in the opposite fashion (high TTL to low TTL) than traceroute/tracert. Note that most routers will not send ICMP TTL exceeded packets, and will thus show up as <code class="language-plaintext highlighter-rouge">*</code>.</li>
</ul>
<h2 id="nmap-scripting-engine-nse">Nmap Scripting Engine (NSE)</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-sC</code> - Run all default scripts (as applicable).</li>
<li><code class="language-plaintext highlighter-rouge">--script</code> - Run specified scripts, or all scripts in a specified category (as applicable). Also accepts wildcard matches (e.g., <code class="language-plaintext highlighter-rouge">ftp*</code>).</li>
</ul>
<p>Nmap script categories:</p>
<ul>
<li>auth - Probes for information about service authentication and bypasses. Does not conduct brute-force attacks.</li>
<li>broadcast - Host/network probes using broadcast packets.</li>
<li>brute - Attempt to brute-force service credentials.</li>
<li>default - A curated list of fast, reliable scripts. Can also be called using -sC.</li>
<li>discovery - Gather additional information about scanned machines/ports.</li>
<li>dos - Scripts that may crash machines/services.</li>
<li>exploit - Attempt to actually exploit identified services.</li>
<li>external - Scripts that send data to third-party services.</li>
<li>fuzzer - Fuzz identified services.</li>
<li>intrusive - Scripts that may crash a service, generate lots of log messages, or are otherwise noise / may be considered malicious.</li>
<li>malware - Test for the possible presence of malware on the target.</li>
<li>safe - The opposite of “intrusive” - scripts that are unlikely to be noisy or perceived as malicious (no guarantees though).</li>
<li>version - Scripts called by -sV. Unlike “default”, this category cannot be called directly.</li>
<li>
<p>vuln - Check for potential vulnerabilities. I’ve found that scripts in this category generate a lot of false positives.</p>
</li>
<li><a href="https://nmap.org/book/nse-usage.html">Nmap Scripting Engine Usage and Examples (Official Nmap Project Guide)</a></li>
</ul>
<h2 id="saving-the-output">Saving the Output</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-oN</code> - Save results as “normal” output. This is more-or-less what nmap will print to STDOUT.</li>
<li><code class="language-plaintext highlighter-rouge">-oG</code> - Save the results as “grepable” output. This is a compact format meant to automatically provide context when searched with grep.</li>
<li><code class="language-plaintext highlighter-rouge">-oX</code> - Save the results as XML, designed to be importable by other applications.</li>
<li><code class="language-plaintext highlighter-rouge">-oA</code> - Save the results in “normal”, “grepable”, and XML formats simultaneously. This option will automatically append meaningful extensions (the other options do not do this).</li>
</ul>
<h2 id="summary-of-nmap-post-port-scans">Summary of Nmap Post Port Scans</h2>
<ul>
<li><code class="language-plaintext highlighter-rouge">-A</code> - Alias for <code class="language-plaintext highlighter-rouge">-sV -O -sC --traceroute</code>.</li>
</ul>
<h2 id="telnet">Telnet</h2>
<p>The default port for <code class="language-plaintext highlighter-rouge">telnetd</code> is TCP 23.</p>
<h2 id="hypertext-transfer-protocol-http">Hypertext Transfer Protocol (HTTP)</h2>
<p>Minimal valid HTTP request:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">host</span><span class="p">:</span> <span class="s">something</span>
</code></pre></div></div>
<p>(Note the blank line at the end.)</p>
<h2 id="file-transfer-protocol-ftp">File Transfer Protocol (FTP)</h2>
<p>FTP commands:</p>
<ul>
<li>USER - Specify the username for the account logging on.</li>
<li>PASS - Specify the password for the account logging on.</li>
<li>STAT - Provide connection/server information.</li>
<li>SYST - Provide system “type” information.</li>
<li>PASV - Switch to passive mode.</li>
<li>TYPE - Switch between ASCII (A) and binary (I) transfer modes.</li>
</ul>
<p>Note that you cannot receive files using FTP with telnet/netcat, as file transfers are conducted over a separate channel (either a channel originating from port 20 on the server for “active” mode or a random port above 1023 on the client for “passive” mode).</p>
<h2 id="simple-mail-transfer-protocol-smtp">Simple Mail Transfer Protocol (SMTP)</h2>
<p>A set of commands to send an email:</p>
<pre><code class="language-smtp">HELO somehostname
MAIL FROM:fromaddress@host1.tld
RCPT TO:toaddress@host2.tld
DATA
To: "To Address" &lt;toaddress@host2.tld&gt;
From: "From Address" &lt;fromaddress@host1.tld&gt;
Subject: An Email
This is content.
Here is another line.
.
QUIT
</code></pre>
<p>Note that MAIL FROM / From and RCPT TO / To are not actually required to match, though failure to fill in the MAIL FROM / RCPT TO commands <em>may</em> result in the message being rejected. The commands above are <em>not</em> case-sensitive, and the message ends with a <code class="language-plaintext highlighter-rouge">.</code> on a single line.</p>
<ul>
<li><a href="https://stackoverflow.com/questions/10822190/in-smtp-must-the-rcpt-to-and-to-match">In SMTP, must the RCPT TO: and TO: match?</a></li>
</ul>
<h2 id="post-office-protocol-3-pop3">Post Office Protocol 3 (POP3)</h2>
<p>POP3 commands:</p>
<ul>
<li>USER - Username to use for authentication</li>
<li>PASS - Password to use for authentication</li>
<li>STAT - Mailbox statistics (+OK $TOTAL_MSGS $MBOX_SIZE_BYTES)</li>
<li>LIST - List messages ($MSG_NUMBER $MSG_SIZE_BYTES)</li>
<li>RETR - Retrieve message $MESSAGE_NUMBER</li>
<li>QUIT - Close connection</li>
</ul>
<h2 id="internet-message-access-protocol-imap">Internet Message Access Protocol (IMAP)</h2>
<p>IMAP commands are much more complicated than POP3. Some examples:</p>
<ul>
<li>Login User - prefix LOGIN user pass</li>
<li>List Folders - prefix LIST “” “*”</li>
<li>List Emails in INBOX - prefix EXAMINE INBOX</li>
<li>Close Connection - prefix LOGOUT</li>
</ul>
<p>Here <code class="language-plaintext highlighter-rouge">prefix</code> is a random prefix we provide to track server replies to various commands. IMAP accepts a lot of different user authentication methods; LOGIN is just the simplest (and least secure).</p>
<h2 id="introduction-to-attacking-protocols-and-servers">Introduction to Attacking Protocols and Servers</h2>
<p>The CIA triad has an attacker’s counterpart:</p>
<ul>
<li>Confidentiality &lt;-&gt; Disclosure</li>
<li>Integrity &lt;-&gt; Alteration</li>
<li>Availability &lt;-&gt; Destruction</li>
</ul>
<h2 id="sniffing-attack">Sniffing Attack</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Quick-n-dirty packet capture</span>
<span class="c">#</span>
<span class="nb">sudo </span>tcpdump port <span class="nv">$PORT_TO_FILTER_ON</span> <span class="nt">-A</span>
</code></pre></div></div>
<p>The <code class="language-plaintext highlighter-rouge">-A</code> flag prints packet contents in ASCII. Wireshark is obviously nicer.</p>
<h2 id="transport-layer-security-tls">Transport Layer Security (TLS)</h2>
<p>SSL/TLS operate on the OSI presentation layer (layer 6).</p>
<p>DoT = DNS-over-TLS</p>
<ul>
<li><a href="https://cardboard-iguana.com/notes/osi-model.html">OSI Model</a></li>
</ul>
<h2 id="password-attack">Password Attack</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Generic Hydra invocation</span>
<span class="c">#</span>
hydra <span class="nt">-l</span> <span class="nv">$USERNAME</span> <span class="nt">-P</span> <span class="nv">$WORDLIST</span> <span class="nv">$SERVER</span> <span class="nv">$SERVICE</span>
<span class="c"># For example...</span>
<span class="c">#</span>
hydra <span class="nt">-l</span> john <span class="se">\</span>
<span class="nt">-P</span> ~/.local/share/red-team/wordlists/rockyou.txt <span class="se">\</span>
10.10.10.100 ssh
</code></pre></div></div>
<p>Additional Hydra options:</p>
<ul>
<li><code class="language-plaintext highlighter-rouge">-s</code> - Specify a non-default port.</li>
<li><code class="language-plaintext highlighter-rouge">-V</code> - Verbose. Also use <code class="language-plaintext highlighter-rouge">-vV</code> for something more verbose, or <code class="language-plaintext highlighter-rouge">-d</code> for debugging output.</li>
<li><code class="language-plaintext highlighter-rouge">-t</code> - Specify the number of parallel attempts.</li>
</ul>
<p>Note that Hydra doesn’t stop automatically after a password is found.</p>
<ul>
<li><a href="https://cardboard-iguana.com/notes/hydra.html">Using Hydra</a></li>
</ul>
<h2 id="summary-of-attacking-protocols-and-servers">Summary of Attacking Protocols and Servers</h2>
<p>FTPS uses TCP 990 by default.</p>