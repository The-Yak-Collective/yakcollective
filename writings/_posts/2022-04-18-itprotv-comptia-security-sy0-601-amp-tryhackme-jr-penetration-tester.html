---
title: 'ITPro.TV: CompTIA Security+ (SY0-601) &amp; TryHackMe: Jr. Penetration Tester'
date: 2022-04-18 12:00:00.000000000 Z
layout: post-external
original_link: https://cardboard-iguana.com/log/2022-04-18-itprotv-comptia-security-plus-and-tryhackme-jr-penetration-tester.html
author: 100007
---

<h1 id="itprotv-comptia-security-sy0-601--tryhackme-jr-penetration-tester">ITPro.TV: CompTIA Security+ (SY0-601) &amp; TryHackMe: Jr. Penetration Tester</h1>
<p><strong>author:</strong> Nathan Acks<br />
<strong>date:</strong> 2022-04-18</p>
<h1 id="comptia-security-exam-cram">CompTIA Security+ Exam Cram</h1>
<p>Today’s reading is Chapter 28 from the Security+ Exam Cram, “Incident Investigation”.</p>
<h2 id="siem-dashboards">SIEM Dashboards</h2>
<p>The key to SIEM alerting is the correlation engine - looking for user connections <em>after</em> that user has left the office, etc.</p>
<h2 id="logging">Logging</h2>
<p>Log files = documentation (of system/application/user activity)</p>
<blockquote>
<p>Web server logs are usually access logs, common error logs, custom logs, and W3C logs. W3C logs are used mainly by web servers to log web-related events, including web logs.</p>
</blockquote>
<p>Huh?</p>
<p>(It looks like W3C logs are just a particular standardized log format. Despite coming out of the W3C, only IIS and Amazon Cloudfront seem to use this.)</p>
<p>Windows Event Log fields:</p>
<ul>
<li>Type - Warning, error, information, etc.</li>
<li>Time - Date/time for the computer <em>sending</em> the log</li>
<li>Computer - Computer name</li>
<li>Provider Type - The facility that generated the event (generally the Windows Event Log)</li>
<li>Provider Name - The name of the log (Application, Security, etc.)</li>
<li>Source - Application</li>
<li>Event ID - Standardized (<em>not</em> unique!) identifier</li>
<li>Description - Self-explanatory</li>
</ul>
<p>Event IDs from the Windows Event Log can generally be looked up in the Microsoft Knowledge base.</p>
<p>One way to think about SNMP is as a data source for multi-system logs.</p>
<p>A Windows-centric list of log types:</p>
<ul>
<li>System</li>
<li>Audit (events important for auditing and forensics needs; user logins go here)</li>
<li>Security</li>
<li>Access (system-to-system - not user! - access events)</li>
</ul>
<p>Anomaly detection generally works better on network logs than device logs.</p>
<p>Heh… <code class="language-plaintext highlighter-rouge">journald</code> <em>still</em> doesn’t have remote logging, instead relying on forwarding to a syslog-compatible daemon.</p>
<ul>
<li><a href="https://www.screamingfrog.co.uk/an-seos-guide-to-w3c-log-files/">An SEOs Guide To W3C Log Files</a></li>
</ul>
<h2 id="network-activity">Network Activity</h2>
<p>Most network activity monitoring tools don’t store actual packets, but rather just log metadata about those packets (minimally: source, destination, protocol).</p>
<h2 id="protocol-analyzers">Protocol Analyzers</h2>
<p>Protocol Analyzer = Packet Sniffer</p>
<p>Now we’re talking about actual packet capture!</p>
<h2 id="network-flow">Network Flow</h2>
<p>A.k.a. “NetFlow” (originally a Cisco thing, but since genericized). Basically, this is packet capture and analysis on router interfaces. NetFlow (and related tools like sFlow) are oriented towards understanding network usage rather than the behavior of individual machines/connections.</p>
<p>NetFlow data is exported using the IPFIX (Internet Protocol Flow Information Export) format.</p>
<h1 id="itprotv-comptia-security-sy0-601">ITPro.TV: CompTIA Security+ (SY0-601)</h1>
<h2 id="investigational-data-sources">Investigational Data Sources</h2>
<p>SIEM = You 10,000 ft view</p>
<p>The SIEM correlation engine is just a (user defined?) list of event sequences of interest.</p>
<p>IPFIX is an IETF standard.</p>
<p>Wireshark has some statistical packet-analysis capabilities.</p>
<p>General log analysis flow: Filtered down to warnings/errors, locate an event of interest, and then expand your search around that timeframe to include lower-level/priority events.</p>
<p>Call out to WinDbg Preview, which is a free Windows dump file analyzer in the Microsoft Store. Windows typically stores dump files in <code class="language-plaintext highlighter-rouge">C:\Windows</code>, so you’ll need to copy it out to view it.</p>
<h1 id="tryhackme-jr-penetration-tester">TryHackMe: Jr. Penetration Tester</h1>
<h2 id="introduction-to-meterpreter">Introduction to Meterpreter</h2>
<p>Meterpreter is fileless, and attempts to mask itself using other process names. It only communicates back to Metasploit on an encrypted channel.</p>
<p>However, most modern antivirus <em>will</em> still recognize it.</p>
<h2 id="meterpreter-flavors">Meterpreter Flavors</h2>
<p>Meterpreter supports a wide range of operating systems; there are even variants designed to live inside of common server-side interpreters (Java, Python, and PHP). Most payload versions are singletons, though there are a few staged variants.</p>
<p>Most variants support communication over HTTP (unencrypted), HTTPS, or raw TCP (encrypted). IPv6 (which is often poorly monitored if allowed) is also an option.</p>
<p>As always, be aware that some exploits may limit the available Meterpreter payloads.</p>
<h2 id="meterpreter-commands">Meterpreter Commands</h2>
<p>Meterpreter’s commands vary depending on host OS. Some notable commands:</p>
<ul>
<li><code class="language-plaintext highlighter-rouge">background</code> - Background the current session</li>
<li><code class="language-plaintext highlighter-rouge">clearenv</code> - Clears the (Windows) event logs (kinda obvious)</li>
<li><code class="language-plaintext highlighter-rouge">download</code> - Transfer a file from the target to the attacker</li>
<li><code class="language-plaintext highlighter-rouge">edit</code> - Edit a file</li>
<li><code class="language-plaintext highlighter-rouge">execute</code> - Execute a command on the host</li>
<li><code class="language-plaintext highlighter-rouge">getpid</code> - Get current process ID</li>
<li><code class="language-plaintext highlighter-rouge">getsystem</code> - Attempt to elevate to SYSTEM/root</li>
<li><code class="language-plaintext highlighter-rouge">getuid</code> - Get current process user</li>
<li><code class="language-plaintext highlighter-rouge">guid</code> - Get session ID</li>
<li><code class="language-plaintext highlighter-rouge">hashdump</code> - Dump NTLM hashes (on Windows)</li>
<li><code class="language-plaintext highlighter-rouge">ifconfig</code> - Display host network interface information</li>
<li><code class="language-plaintext highlighter-rouge">info</code> - Get information about a Meterpreter extension</li>
<li><code class="language-plaintext highlighter-rouge">load</code> - Load Meterpreter extension</li>
<li><code class="language-plaintext highlighter-rouge">migrate</code> - Migrate Meterpreter to another process</li>
<li><code class="language-plaintext highlighter-rouge">netstat</code> - Display host network connections</li>
<li><code class="language-plaintext highlighter-rouge">portfwd</code> - Forward a port on the host</li>
<li><code class="language-plaintext highlighter-rouge">route</code> - Mess with the host routing tables</li>
<li><code class="language-plaintext highlighter-rouge">run</code> - Run a meterpreter extension</li>
<li><code class="language-plaintext highlighter-rouge">search</code> - Search for files</li>
<li><code class="language-plaintext highlighter-rouge">sessions</code> - Switch to another (Metasploit) session</li>
<li><code class="language-plaintext highlighter-rouge">shell</code> - Drop to system shell</li>
<li><code class="language-plaintext highlighter-rouge">sysinfo</code> - Pull remote system information</li>
<li><code class="language-plaintext highlighter-rouge">upload</code> - Transfer a file from the attacker to the target</li>
</ul>
<h2 id="post-exploitation-with-meterpreter">Post-Exploitation with Meterpreter</h2>
<p>Migrating Meterpreter to another process sometimes makes new commands become available; for example, migrating to a text editor will allow you to capture keystrokes.</p>
<p>Note that Meterpreter will happily let you migrate from a privileged to an unprivileged process - which may cause you to loose control of the target system!</p>
<p>You can background system shells launched from Meterpreter with <code class="language-plaintext highlighter-rouge">Ctrl + Z</code> to return to the parent (Meterpreter) process.</p>
<h2 id="post-exploitation-challenge">Post-Exploitation Challenge</h2>
<p>It’s always good to look at <code class="language-plaintext highlighter-rouge">help</code> in Meterpreter after loading a new module.</p>
<p>Remember that <code class="language-plaintext highlighter-rouge">load kiwi</code> will pull in a Meterpreter-specific version of Mimikatz!</p>
<p>Use <code class="language-plaintext highlighter-rouge">net share</code> on Windows to list <em>all</em> current shares. The Metasploit <code class="language-plaintext highlighter-rouge">post/windows/gather/enum_shares</code> module provides cleaner output (requires backgrounding Meterpreter).</p>
<p>To execute <code class="language-plaintext highlighter-rouge">hashdump</code> you will need to be connected to the <code class="language-plaintext highlighter-rouge">lsass.exe</code> process.</p>
<p>Note that migrating Meterpreter will change its current working directory to that of the process it’s attaching to.</p>
<ul>
<li><a href="https://cardboard-iguana.com/notes/mimikatz.html">Using Mimikatz</a></li>
<li><a href="https://www.computerhope.com/issues/ch000534.htm">How to view all network shares in Windows</a></li>
</ul>