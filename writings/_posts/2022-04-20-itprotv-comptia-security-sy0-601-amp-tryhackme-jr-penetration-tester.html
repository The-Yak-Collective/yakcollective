---
title: 'ITPro.TV: CompTIA Security+ (SY0-601) &amp; TryHackMe: Jr. Penetration Tester'
date: 2022-04-20 05:00:00.000000000 Z
layout: post-external
original_link: https://cardboard-iguana.com/log/2022-04-20-itprotv-comptia-security-plus-and-tryhackme-jr-penetration-tester.html
author: 100007
---

<h1 id="itprotv-comptia-security-sy0-601--tryhackme-jr-penetration-tester">ITPro.TV: CompTIA Security+ (SY0-601) &amp; TryHackMe: Jr. Penetration Tester</h1>
<p><strong>author:</strong> Nathan Acks<br />
<strong>date:</strong> 2022-04-20</p>
<h2 id="itprotv-comptia-security-sy0-601">ITPro.TV: CompTIA Security+ (SY0-601)</h2>
<h3 id="incident-response-process">Incident Response Process</h3>
<p>Event = Something that raises a potential security flag.</p>
<p>Incident = A violation of some security process or policy.</p>
<p>Phases:</p>
<ul>
<li>Preparation (logging and monitoring)</li>
<li>Identification (detection, analysis, and alerting of <em>events</em>)</li>
<li>Containment (network isolation, system shutdowns, etc.)</li>
<li>Eradication (malware removal, wipe-and-reload, etc. <em>and</em> verify that no additional systems are impacted)</li>
<li>Recovery (return to normal… <em>after</em> verification of eradication)</li>
<li>Lessons Learned</li>
</ul>
<p>Part of recovery is ascertaining <em>how</em> the incident occurred and remediating the associated vulnerability/vulnerabilities.</p>
<p>A good distinction: A “runbook” is an <em>automated</em> playbook.</p>
<p>Things to have in your after action report:</p>
<ul>
<li>What went right?</li>
<li>What went… well?</li>
<li>What went wrong?</li>
<li>What was impacted?</li>
<li>How was the attack accomplished?</li>
<li>How can existing systems be improved?</li>
</ul>
<h3 id="incident-response-plans">Incident Response Plans</h3>
<ul>
<li>Who are you reporting to? Who approves your actions? Who initiates the incidence response process?</li>
<li>Who’s on your team? (IT, experts, consultants, LEOs, etc.)</li>
<li>Who are your stakeholders? What are your responsibilities to them? How will they be communicated with?</li>
<li>How are internal comms handled? External comms? (And when?)</li>
<li>How is evidence handled, documented, and retained?</li>
</ul>
<p>BCDRP = Business Continuity and Disaster Recovery Plan</p>
<p>Exercises, in order of how closely they mimic/interrogate the IRP:</p>
<ul>
<li>Tabletop exercises</li>
<li>Walkthroughs</li>
<li>Simulations</li>
</ul>
<p>There’s actually a tabletop game created by Black Hills Information Security that’s designed to help with tabletop exercises.</p>
<ul>
<li><a href="https://www.blackhillsinfosec.com/projects/backdoorsandbreaches/">Backdoors &amp; Breaches</a></li>
</ul>
<h3 id="attack-frameworks">Attack Frameworks</h3>
<p>An “attack framework” is just a way to describe an attack in a standardized fashion.</p>
<ul>
<li>MITRE ATT&amp;CK (Adversarial Tactics, Techniques &amp; Common Knowledge)</li>
<li>Diamond Model (from top clockwise: adversary, capabilities, victim, infrastructure)</li>
<li>Cyber Kill Chain (recon, weaponization, delivery, exploitation, installation, command and control, actions on objective)</li>
</ul>
<p>The diamond model can be summarized as, “for every intrusion, there exists an <em>adversary</em> who is using their <em>capabilities</em> over/with some kind of infrastructure <em>infrastructure</em> to attack a <em>victim</em>.”</p>
<p>MITRE ATT&amp;CK is really the gold standard though.</p>
<ul>
<li><a href="https://attack.mitre.org/">MITRE ATT&amp;CK</a></li>
</ul>
<h2 id="tryhackme-jr-penetration-tester">TryHackMe: Jr. Penetration Tester</h2>
<h3 id="enumeration">Enumeration</h3>
<p>Useful Linux post-exploit enumeration commands</p>
<ul>
<li><code class="language-plaintext highlighter-rouge">hostname</code></li>
<li><code class="language-plaintext highlighter-rouge">uname -a</code></li>
<li><code class="language-plaintext highlighter-rouge">cat /proc/version</code></li>
<li><code class="language-plaintext highlighter-rouge">cat /etc/issue</code></li>
<li><code class="language-plaintext highlighter-rouge">ps auxww</code> (lots and lots of process info)</li>
<li><code class="language-plaintext highlighter-rouge">ps auxfww</code> (process tree)</li>
<li><code class="language-plaintext highlighter-rouge">env</code></li>
<li><code class="language-plaintext highlighter-rouge">sudo -l</code> (create log enteries!)</li>
<li><code class="language-plaintext highlighter-rouge">ls</code> (of course)</li>
<li><code class="language-plaintext highlighter-rouge">id</code></li>
<li><code class="language-plaintext highlighter-rouge">cat /etc/passwd</code></li>
<li><code class="language-plaintext highlighter-rouge">history</code></li>
<li><code class="language-plaintext highlighter-rouge">ifconfig</code></li>
<li><code class="language-plaintext highlighter-rouge">ip route</code></li>
<li><code class="language-plaintext highlighter-rouge">netstat -a</code> (all listening parts and established connections)</li>
<li><code class="language-plaintext highlighter-rouge">netstat -l</code> (only listening ports)</li>
<li><code class="language-plaintext highlighter-rouge">netstat -s</code> (protocol statistics)</li>
<li><code class="language-plaintext highlighter-rouge">netstat -p</code> (protocol and service information, requires root to see everything)</li>
<li><code class="language-plaintext highlighter-rouge">netstat -i</code> (per interface statistics)</li>
<li><code class="language-plaintext highlighter-rouge">netstat -ano</code></li>
<li><code class="language-plaintext highlighter-rouge">find</code> (various permutations)</li>
<li><code class="language-plaintext highlighter-rouge">locate</code></li>
</ul>
<p>Instead of <code class="language-plaintext highlighter-rouge">u</code>, <code class="language-plaintext highlighter-rouge">j</code> can be used with <code class="language-plaintext highlighter-rouge">ps</code> to get a slightly different column output format. This is mostly useful for finding out numeric user IDs and <em>parent</em> process IDs.</p>
<p>The <code class="language-plaintext highlighter-rouge">netstat</code> command supports the <code class="language-plaintext highlighter-rouge">-t</code> and <code class="language-plaintext highlighter-rouge">-u</code> flags to limit returned ports to TCP and UDP, respectively. Note that by default <code class="language-plaintext highlighter-rouge">netstat</code> will try to resolve hostnames, which can cause hangs; use <code class="language-plaintext highlighter-rouge">-n</code> to skip this (and only display IP addresses).</p>
<h3 id="automated-enumeration-tools">Automated Enumeration Tools</h3>
<ul>
<li><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">LinPeas</a></li>
<li><a href="https://github.com/rebootuser/LinEnum">LinEnum</a></li>
<li><a href="https://github.com/mzet-/linux-exploit-suggester">LES (Linux Exploit Suggester)</a></li>
<li><a href="https://github.com/diego-treitos/linux-smart-enumeration">Linux Smart Enumeration</a></li>
<li><a href="https://github.com/linted/linuxprivchecker">Linux Priv Checker</a></li>
</ul>
<p>Of these, only LES is available in the Kali Linux repos (<code class="language-plaintext highlighter-rouge">sudo apt install linux-exploit-suggester</code>).</p>
<h3 id="privilege-escalation-sudo">Privilege Escalation: Sudo</h3>
<p>Basically: GTFOBins!</p>
<p>Sometimes, you can also get applications to leak information about sensitive files (such as <code class="language-plaintext highlighter-rouge">/etc/shadow</code> by passing these as if they were configuration files. Apache is one app that does this.</p>
<p>Also, exploiting <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code>.</p>
<p>Exploiting <code class="language-plaintext highlighter-rouge">sudo nano</code>:</p>
<ul>
<li><code class="language-plaintext highlighter-rouge">CTRL+R</code> (read file)</li>
<li><code class="language-plaintext highlighter-rouge">CTRL+X</code> (execute file)</li>
<li><code class="language-plaintext highlighter-rouge">reset; sh 1&gt;&amp;0 2&gt;&amp;0</code></li>
</ul>
<p>Exploiting <code class="language-plaintext highlighter-rouge">sudo less</code> is as simple as <code class="language-plaintext highlighter-rouge">!/bin/sh</code>.</p>
<p>If <code class="language-plaintext highlighter-rouge">find</code> can be run with <code class="language-plaintext highlighter-rouge">sudo</code>, then try <code class="language-plaintext highlighter-rouge">sudo find . -exec /bin/sh \; -quit</code>.</p>
<ul>
<li><a href="https://gtfobins.github.io">GTFOBins</a></li>
<li><a href="https://cardboard-iguana.com/notes/exploiting-ld-preload.html">Exploiting LD_PRELOAD</a></li>
</ul>
<h3 id="privilege-escalation-suid">Privilege Escalation: SUID</h3>
<p>Find (not always so quickly) SUID and SGID files:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find / <span class="nt">-type</span> f <span class="nt">-perm</span> <span class="nt">-04000</span> <span class="nt">-ls</span> 2&gt;/dev/null
</code></pre></div></div>
<p>Note that Linux systems still fall back to password hashes in <code class="language-plaintext highlighter-rouge">/etc/passwd</code> if an entry in <code class="language-plaintext highlighter-rouge">/etc/shadow</code> isn’t present. This means that we can just directly add root-equivalent users directly here (remember that the UID and primary GID can be duplicated!).</p>
<p>To generate a password acceptable for inclusion in <code class="language-plaintext highlighter-rouge">/etc/passwd</code>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl passwd <span class="nt">-1</span> <span class="nt">-salt</span> <span class="nv">$SALT</span> <span class="nv">$PASSWORD</span>
</code></pre></div></div>
<h3 id="privilege-escalation-capabilities">Privilege Escalation: Capabilities</h3>
<p>“Capabilities” are finer-grained permissions that can be assigned to a binary. Think of them as a kind of granular SUID/SGID.</p>
<p>The <code class="language-plaintext highlighter-rouge">getcap</code> command displays a binary’s capabilities (if there are any), and can even be used to perform a search for such binaries using <code class="language-plaintext highlighter-rouge">getcap -r $PATH 2&gt; /dev/null</code>.</p>
<h3 id="privilege-escalation-cron-jobs">Privilege Escalation: Cron Jobs</h3>
<p>Basically, check to see if any scripts run by a privileged user can be written to by an unprivileged user.</p>
<p>Also look for “zombie” cron jobs that are still running but refer to a non-existent file in a writable location.</p>
<p>Bash as a reverse proxy makes an appearance again here.</p>
<h3 id="privilege-escalation-nfs">Privilege Escalation: NFS</h3>
<p>NFS exports are listed in <code class="language-plaintext highlighter-rouge">/etc/exports</code>; if an export is configured with <code class="language-plaintext highlighter-rouge">no_root_squash</code>, then root permissions won’t be stripped from created files and it’s possible to create root-owned SUID/SGID binaries on the mount. (Remember that files on NFS mounts are created using the UID/GID values of the <em>local</em> user!)</p>