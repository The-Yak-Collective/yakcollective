---
title: 'OffSec Live: PEN-200'
date: 2022-08-05 12:00:00.000000000 Z
layout: post-external
original_link: https://cardboard-iguana.com/log/2022-08-05-offsec-live-pen-200.html
author: 100007
---

<h1 id="offsec-live-pen-200">OffSec Live: PEN-200</h1>
<p><strong>author:</strong> Nathan Acks<br />
<strong>date:</strong> 2022-08-05</p>
<p>Today on OffSec Live we’ll be covering Linux privilege escalation.</p>
<ul>
<li><a href="https://www.offensive-security.com/offsec/offsec-live/">OffSec Live</a></li>
<li><a href="https://learn.offensive-security.com/offsec-live-webinars">Join OffSec Live</a></li>
</ul>
<h1 id="file-permissions">File Permissions</h1>
<p>Oh, I hadn’t noticed this before, but the *NIX read/write/execute bits are represented in that order in the permission bitmask, which is why <code class="language-plaintext highlighter-rouge">r</code> is <code class="language-plaintext highlighter-rouge">4</code>, <code class="language-plaintext highlighter-rouge">w</code> is <code class="language-plaintext highlighter-rouge">2</code>, and <code class="language-plaintext highlighter-rouge">x</code> is <code class="language-plaintext highlighter-rouge">1</code>. (Or, an easier mnemonic might be “they’re read in <em>descending</em> order”.)</p>
<p>When using symbolic permissions with <code class="language-plaintext highlighter-rouge">chmod</code>, leaving off the <code class="language-plaintext highlighter-rouge">ugo</code> bit will result in the permission being applied to all three categories. For more complex expressions, different permission changes can be separated with a comma (<code class="language-plaintext highlighter-rouge">,</code>) - for example, <code class="language-plaintext highlighter-rouge">chmod ug+x,o-w file.txt</code>.</p>
<h1 id="the-suid--sgid-bits">The SUID &amp; SGID Bits</h1>
<p>Find SUID files: <code class="language-plaintext highlighter-rouge">find / -type f -perm -u=s -ls 2&gt;/dev/null</code></p>
<p>Not sure if a binary is normally SUID? Compare the results of the above command with the same output on your local (Linux) box.</p>
<p>The presence of the SUID/SGID bit only <em>allows</em> a program to elevate its privileges to match its user/group - a call to <code class="language-plaintext highlighter-rouge">setresuid()</code> and/or <code class="language-plaintext highlighter-rouge">setregid()</code> (or work-alikes) is still required to actually perform the (presumably legitimate) privilege escalation!</p>
<ul>
<li><a href="https://cardboard-iguana.com/notes/how-to-use-find-with-file-metadata.html">How to Use “find” With File Metadata</a></li>
<li><a href="https://gtfobins.github.io/">GTFOBins</a></li>
</ul>
<h1 id="exploiting-the-suid-bit">Exploiting the SUID Bit</h1>
<p>In the output of the <code class="language-plaintext highlighter-rouge">id</code> command, the <code class="language-plaintext highlighter-rouge">euid</code> and <code class="language-plaintext highlighter-rouge">egid</code> are the <em>effective</em> user and group IDs.</p>
<p>When exploiting binaries that call other binaries, look for places where the absolute path has not been used and then see if you can manipulate the PATH so that a binary <em>you</em> control is called instead!</p>