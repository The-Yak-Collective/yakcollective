---
title: AWS Deep Dive
date: 2022-10-02 12:00:00.000000000 Z
layout: post-external
original_link: https://cardboard-iguana.com/log/2022-10-02-aws-deep-dive.html
author: 100007
---

<h1 id="aws-deep-dive">AWS Deep Dive</h1>
<p><strong>author:</strong> Nathan Acks<br />
<strong>date:</strong> 2022-10-02</p>
<h1 id="amazon-api-gateway">Amazon API Gateway</h1>
<p>More notes about the Amazon API Gateway. (In the interest of time I’m skipping the “Tutorials and Workshops” section of Amazon’s documentation, however.)</p>
<h2 id="getting-started">Getting Started</h2>
<p>API Gateway automatically integrates with Lambda, showing available functions when creating new APIs. Handy!</p>
<p>API routes (URL endpoints) by default match the name of the corresponding Lambda function, though this can be changed.</p>
<p>Creating a Lambda function automatically creates an associated CloudWatch log group and an IAM role for execution. So, this is a reason for using something like CloudFormation to automate things, though you’d think that AWS would just ask the user if these objects should be deleted when the function is removed.</p>
<ul>
<li><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/getting-started.html">Getting started with API Gateway</a></li>
</ul>
<h2 id="working-with-rest-apis">Working with REST APIs</h2>
<ul>
<li><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-rest-api.html">Amazon API Gateway: Working with REST APIs</a></li>
</ul>
<h3 id="creating-a-rest-api-in-amazon-api-gateway">Creating a REST API in Amazon API Gateway</h3>
<p>Backend replies are expected to happen synchronously relative to the corresponding frontend requests with the API Gateway’s REST API feature.</p>
<p>The REST API model: Resources (logical API object collections) &gt; Entities (API object paths) &gt; Method Requests (HTTP verbs + expected request bodies) &gt; Integrations (mappings to backend URIs + necessary transforms) &gt; Integration Responses (per-HTTP response code behavior + any necessary transformations for backend response) &gt; Method Responses (per-HTTP response code behavior for returned integration responses). Separately, a “Documentation Part” can be added for internal/external documentation.</p>
<p>It’s remains unclear to me why integration and method response parts are handled in separate parts of the chain.</p>
<p>Types of API endpoints:</p>
<ul>
<li>Edge-Optimized (using CloudFront; use capitalized HTTP header names)</li>
<li>Regional (per-region, though they can be routed to dynamically using Route 53; pass HTTP headers as-is with some exceptions)</li>
<li>Private (can only be accessed within a VPC; pass HTTP headers as-is)</li>
</ul>
<p>Edge-optimized endpoints are the default; the other options allow either less expensive / more responsive implementations when global coverage isn’t necessary (regional) or when an API is purely internal (private). API endpoint types can be updated, but only within a (somewhat obvious) chain: Edge-Optimized &lt;-&gt; Regional &lt;-&gt; Private.</p>
<p>The distinction between “resources” and “entities” within API gateway is somewhat arbitrary - really what you’re doing is building a tree of endpoints that map to various API paths. Dynamic path elements can be specified as &#x007b;dynamicPathElementName&#x007d;; these need to be references as requestParameters within the API as method.request.path.dynamicPathElementName (and must be explicitly marked as required).</p>
<p>OpenAPI JSON objects can also be directly imported to build out APIs.</p>
<p>The API Gateway will throw an exception for calls that use invalid paths, without ever passing the request to the corresponding backend.</p>
<p>A “catch all” response can be configured in the API Gateway for when the API backend doesn’t respond in an expected manner. Interestingly, Amazon <em>recommends</em> configuring the API Gateway to throw a 500 in these cases.</p>
<p>The API Gateway also supports a special “proxy” resource that allows API paths to be built (and changed) dynamically. Proxy resources are specified using &#x007b;proxy+&#x007d; and function like <code class="language-plaintext highlighter-rouge">*</code>.</p>
<p>(To be continued…)</p>
<ul>
<li><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/how-to-create-api.html">Creating a REST API in Amazon API Gateway</a></li>
</ul>